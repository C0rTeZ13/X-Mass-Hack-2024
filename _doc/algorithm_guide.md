# Описание процесса обучения модели

## Содержание

- [Описание процесса обучения модели](#описание-процесса-обучения-модели)
  - [Содержание](#содержание)
  - [Предобработка данных](#описание-процесса)
  - [Обучение модели](#обучение-модели)

## Предобработка данных

[Исходный датасет](https://docs.google.com/spreadsheets/d/1HHRQRlPoFrFtd7l3bWmI4gpERZrCETO3/edit?gid=481063430#gid=481063430) состоит из **127469** записей и **28** атрибутов (признаков). Он содержит множественные пропуски и требует дополнения данных, также необходимо решить какие из признаков по нашему мнению следует использовать в процессе обучения.

По итогам проведенного анализа было выделено 14 важных признаков:
* Уставной капитал
* Основной ОКВЭД
* Кол-во дополнительных ОКВЭДОВ
* Нормализованно Кол-во сотрудников
* Система налогообложения
* Отношение оборотов
* Нормализованно Доходы (тыс, руб.)
* ЗСК
* Мошенники
* Сервисы регистраторы
* Вся негативная информация
* Нормализованно Налоговая нагрузка
* Оценка надежности
* Нормализованно Возможная сумма при 3% 

Они используются для расчета целевой переменной **score**, по которой будет определяться вердикт **result** - выдавать кредит или нет.

Новые признаки [Оценка надежности] и [Нормализованно Возможная сумма при 3%] были взяты с сайта по проверке контрагентов [vbankcenter](https://vbankcenter.ru/contragent). Также признаки [Основной ОКВЭД], [Нормализованно Кол-во сотрудников], [Нормализованно Доходы (тыс, руб.)] могут быть взяты с этого сервиса.

Для обучения были использованы лишь 20000 дополненных записей.

## Обучение модели

Задача была определена как бинарная классификация, для решения которой использовалась библиотека CatBoost. 

Как target был выбран **result**. Обучение проводилось на описанных выше признаках, за исключением [ЗСК], так как если учитывать его в процессе, то модель слишком сильно переобучалась (accuracy=0.9999).

В итоге получен следующий результат по определению надежности клиента:
* 1 - Выдаем кредит
* 0 - Не выдаем

![ ](/_image/classification_report.png)

Представлены два графика, отражающих важность каждого фактора при принятии решения:

![ ](/_image/model_features.png)

![ ](/_image/model_features_2.png)